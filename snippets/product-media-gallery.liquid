{% comment %}
  Renders a product media gallery. Should be used with 'media-gallery.js'
  Also see 'product-media-modal'

  Accepts:
  - product: {Object} Product liquid object
  - variant_images: {Array} Product images associated with a variant
  - limit: {Number} (optional) When passed, limits the number of media items to render

  Usage:
  {% render 'product-media-gallery' %}
{% endcomment %}

{% assign sorted_media = product.media | sort: 'id' %}
{% assign reversed_media = sorted_media | reverse %}

<media-gallery
  id="MediaGallery-{{ section.id }}"
  role="region"
  aria-label="{{ 'products.product.media.gallery_viewer' | t }}"
  class="product__media-gallery"
>
  <!-- Featured Image -->
  <div id="featured-media-container" class="product__media-item featured-media col-12">
    <img
      id="featured-image"
      class="featured-media__image"
      src=""
      alt=""
    />
  </div>

  <!-- Thumbnails -->
  <div id="media-thumbnails" class="row media-thumbnails grid grid--gap">
    <!-- Thumbnails worden dynamisch geladen via JavaScript -->
  </div>
</media-gallery>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    // Maak een globaal product object dat alle productgegevens bevat
    window.productJSON.media = {{ product.media | json }};

    // Log de productinformatie naar de console voor debugging
    console.log("Product JSON:", window.productJSON);

    // Haal de productmedia uit het globale object
    var productMedia = window.productJSON.media;

    var featuredImageContainer = document.getElementById('featured-media-container');
    var mediaThumbnailsContainer = document.getElementById('media-thumbnails');

    // Controleer of er media beschikbaar is
    if (productMedia && productMedia.length > 0) {
      var featuredMedia = productMedia[0]; // Neem de eerste media als featured
      var featuredImage = document.createElement('img');
      featuredImage.id = 'featured-image-' + featuredMedia.id;
      featuredImage.src = featuredMedia.preview_image.src; // Gebruik de juiste URL voor de afbeelding
      featuredImage.alt = featuredMedia.alt;
      featuredImage.classList.add('featured-media__image');
      featuredImageContainer.appendChild(featuredImage);

      // Genereer thumbnails
      productMedia.forEach(function (media) {
        var thumbnailDiv = document.createElement('div');
        thumbnailDiv.classList.add('product__media-item', 'media-thumbnail', 'col-3');
        thumbnailDiv.setAttribute('data-variant-color', media.alt.includes('color|') ? media.alt.split('|').pop() : 'all');
        thumbnailDiv.setAttribute('data-media-id', media.id);

        var thumbnailImage = document.createElement('img');
        thumbnailImage.src = media.preview_image.src; // Gebruik de juiste URL voor de thumbnail
        thumbnailImage.alt = media.alt;
        thumbnailImage.classList.add('media-thumbnail__image');
        thumbnailImage.addEventListener('click', function () {
          updateFeaturedImage(media.preview_image.src, media.alt); // Update het featured image bij klik
        });

        thumbnailDiv.appendChild(thumbnailImage);
        mediaThumbnailsContainer.appendChild(thumbnailDiv);
      });
    } else {
      console.log("Geen productmedia gevonden.");
    }
  });

  // Functie om de featured image te updaten bij het klikken op een thumbnail
  function updateFeaturedImage(imageUrl, altText) {
    var featuredImage = document.getElementById('featured-image');
    featuredImage.src = imageUrl;
    featuredImage.alt = altText;
  }
</script>







